<UserControl
            xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
            xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
            xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
            xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
            xmlns:dxlc="http://schemas.devexpress.com/winfx/2008/xaml/layoutcontrol"
            xmlns:dxe="http://schemas.devexpress.com/winfx/2008/xaml/editors" 
            xmlns:dxg="http://schemas.devexpress.com/winfx/2008/xaml/grid"
            xmlns:converters="clr-namespace:Medical.AppLayer.Converters"
            xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
            xmlns:cmd="http://www.galasoft.ch/mvvmlight"
            xmlns:dxb="http://schemas.devexpress.com/winfx/2008/xaml/bars"
            xmlns:dx="http://schemas.devexpress.com/winfx/2008/xaml/core"
            xmlns:Serialization="clr-namespace:DevExpress.Xpf.LayoutControl.Serialization;assembly=DevExpress.Xpf.LayoutControl.v16.1" 
            x:Class="Medical.AppLayer.Operator.Views.OperatorView"
            mc:Ignorable="d" 
            
            d:DesignHeight="768" d:DesignWidth="1224"
            x:Name="OperatorControl">
    <UserControl.Resources>
        <converters:RefusalTypeToColorConverter x:Key="RefusalTypeToColorConverter"/>
        <converters:RefusalFlagToImageConverter x:Key="RefusalFlagToImageConverter"/>
        <converters:RefusalTypeToImageConverter x:Key="RefusalTypeToImageConverter"/>
        <converters:RefusalDestToImageConverter x:Key="RefusalDestToImageConverter"/>
        <converters:DiagnosisConverter x:Key="DiagnosisConverter"/>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <converters:InsuranceConverter x:Key="InsuranceConverter"/>
        <converters:MedicalOrganizationConverter x:Key="MedicalOrganizationConverter"/>
        <converters:MedicalOrganizationIdConverter x:Key="MedicalOrganizationIdConverter"/>


        <Style TargetType="{x:Type Control}" x:Key="BaseStyle">
            <Setter Property="FontWeight" Value="Bold" />
        </Style>
        <Style TargetType="{x:Type dxe:TextEdit}" BasedOn="{StaticResource BaseStyle}"/>
        <Style TargetType="{x:Type dxe:ComboBoxEdit}" BasedOn="{StaticResource BaseStyle}"/>
        <Style TargetType="{x:Type dxe:ButtonEdit}" BasedOn="{StaticResource BaseStyle}"/>
        <Style TargetType="{x:Type dxe:DateEdit}" BasedOn="{StaticResource BaseStyle}"/>
        <Style TargetType="{x:Type dxe:MemoEdit}" BasedOn="{StaticResource BaseStyle}"/>

    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <dxb:BarContainerControl DockPanel.Dock="Top" Grid.Row="0">

            <dxb:ToolBarControl Caption="Просмотр" AllowQuickCustomization="False">
                <dxb:BarLinkContainerItem>
                    <dxb:BarButtonItem Content="Сохранить" Glyph="{dx:DXImage Image=Save_16x16.png}" LargeGlyph="{dx:DXImage Image=Save_32x32.png}" Command="{Binding SaveCommand}"/>
                    <dxb:BarButtonItem Content="Отменить изменения" Glyph="{dx:DXImage Image=Reset2_16x16.png}" LargeGlyph="{dx:DXImage Image=Reset2_32x32.png}" Command="{Binding RevertCommand}"/>
                    <dxb:BarItemLinkSeparator/>
                    <dxb:BarButtonItem Content="Проверка полиса" Glyph="{dx:DXImage Image=CheckBox_16x16.png}" LargeGlyph="{dx:DXImage Image=CheckBox_32x32.png}" Command="{Binding CheckPolicyCommand}"/>
                    <dxb:BarItemLinkSeparator/>
                    <dxb:BarButtonItem Content="Просмотр ответа из СРЗ" Glyph="{dx:DXImage Image=Customer_16x16.png}" LargeGlyph="{dx:DXImage Image=Customer_32x32.png}" Command="{Binding ViewSrzCommand}"/>
                    <dxb:BarButtonItem Content="Запрос в СРЗ" Glyph="{dx:DXImage Image=Role_16x16.png}" LargeGlyph="{dx:DXImage Image=Role_32x32.png}" Command="{Binding SendSrzQueryCommand}"/>
                    <dxb:BarItemLinkSeparator/>
                    <dxb:BarButtonItem Content="Поиск в МКБ-10" Glyph="{dx:DXImage Image=Find_16x16.png}" LargeGlyph="{dx:DXImage Image=Find_32x32.png}" Command="{Binding SearchDignosisCommand}"/>
                    <dxb:BarItemLinkSeparator/>
                    <dxb:BarButtonItem Content="Генерация ЕНП" Glyph="{dx:DXImage Image=Wizard_16x16.png}" LargeGlyph="{dx:DXImage Image=Wizard_32x32.png}" Command="{Binding GenerateInpCommand}"/>
                    <dxb:BarItemLinkSeparator IsVisible="{Binding IsInterMode, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    <dxb:BarButtonItem Content="Копия пациента" Glyph="{dx:DXImage Image=Copy_16x16.png}" LargeGlyph="{dx:DXImage Image=Copy_32x32.png}" Command="{Binding CopyPatientCommand}" IsVisible="{Binding IsInterMode, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    <dxb:BarButtonItem Content="Перенос пациента" Glyph="{dx:DXImage Image=Convert_16x16.png}" LargeGlyph="{dx:DXImage Image=Convert_32x32.png}" Command="{Binding MovePatientCommand}" IsVisible="{Binding IsInterMode, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    <dxb:BarButtonItem Content="Исключить пациента" Glyph="{dx:DXImage Image=Remove_16x16.png}" LargeGlyph="{dx:DXImage Image=Remove_32x32.png}" Command="{Binding ExcludePatientCommand}" IsVisible="{Binding IsInterMode, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                    <dxb:BarItemLinkSeparator/>
                    <dxb:BarButtonItem Content="Удалить все МЭКи" Glyph="{dx:DXImage Image=Delete_16x16.png}" LargeGlyph="{dx:DXImage Image=Delete_32x32.png}" Command="{Binding RemoveAllMecCommand}"/>
                </dxb:BarLinkContainerItem>

            </dxb:ToolBarControl>

        </dxb:BarContainerControl>
        <dxlc:LayoutControl Padding="2" ItemSpace="1" Grid.Row="1">
            <dxlc:LayoutGroup Orientation="Vertical">
                <dxlc:LayoutGroup Orientation="Horizontal">
                    <dxlc:LayoutItem Width="150">
                        <dxe:ButtonEdit EditValue="{Binding CurrentPatientPositionText, Mode=OneWay}" Height="22" AllowDefaultButton="False" IsReadOnly="True" Width="140">
                            <dxe:ButtonInfo GlyphKind="Right" Command="{Binding NextPatientCommand}"/>
                            <dxe:ButtonInfo GlyphKind="Last" Command="{Binding LastPatientCommand}"/>
                            <dxe:ButtonInfo GlyphKind="First" IsLeft="True" Command="{Binding FirstPatientCommand}"/>
                            <dxe:ButtonInfo GlyphKind="Left" IsLeft="True" Command="{Binding PrevPatientCommand}"/>
                        </dxe:ButtonEdit>

                    </dxlc:LayoutItem>
                    <dxlc:LayoutItem Width="50">
                        <dxe:ButtonEdit EditValue="{Binding GoToPatientPosition, UpdateSourceTrigger=PropertyChanged}" Height="22" AllowDefaultButton="False" AcceptsReturn="False" >
                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="KeyDown">
                                    <cmd:EventToCommand Command="{Binding GoToPatientPositionKeyCommand}" PassEventArgsToCommand="True" />
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                            <dxe:ButtonInfo GlyphKind="Custom" Command="{Binding GoToPatientPositionCommand}" >
                                <Image Source="../../Resources/Icons/go-next16.png" />
                            </dxe:ButtonInfo>
                        </dxe:ButtonEdit>
                    </dxlc:LayoutItem>
                </dxlc:LayoutGroup>
                <!--Данные пациента-->
                <dxlc:LayoutGroup Header="LayoutGroup" View="Tabs" VerticalAlignment="Stretch">
                    <dxlc:LayoutGroup Header="Пациент" View="Group" Orientation="Vertical">
                        <dxlc:LayoutGroup>
                            <dxlc:LayoutItem Label="ID пациента" LabelPosition="Top">
                                <dxe:TextEdit EditValue="{Binding Patient.PatientId, UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True"/>
                            </dxlc:LayoutItem>
                            <dxlc:LayoutItem Label="№ записи" LabelPosition="Top" Visibility="{Binding IsInterMode, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <dxe:TextEdit EditValue="{Binding Patient.ExternalId, UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True"/>
                            </dxlc:LayoutItem>
                            <dxlc:LayoutItem Label="№ записи" LabelPosition="Top" Visibility="{Binding IsLocalMode, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <dxe:TextEdit EditValue="{Binding Patient.MedicalExternalId, UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True"/>
                            </dxlc:LayoutItem>
                        </dxlc:LayoutGroup>
                        <dxlc:LayoutItem Label="Фамилия" LabelPosition="Top">
                            <dxe:TextEdit EditValue="{Binding Person.Surname, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Имя" LabelPosition="Top">
                            <dxe:TextEdit EditValue="{Binding Person.PName, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" />
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Отчество" LabelPosition="Top">
                            <dxe:TextEdit EditValue="{Binding Person.Patronymic, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutGroup>
                            <dxlc:LayoutItem Label="Дата рождения" LabelPosition="Top">
                                <dxe:DateEdit EditValue="{Binding Person.Birthday, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" NullText="Отсутствует"/>
                            </dxlc:LayoutItem>
                            <dxlc:LayoutItem Label="Пол" LabelPosition="Top">
                                <dxe:ComboBoxEdit x:Name="SexComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Person.Sex, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" NullText="Отсутствует" />
                            </dxlc:LayoutItem>
                        </dxlc:LayoutGroup>
                        <dxlc:LayoutItem Label="Тип документа ОМС" LabelPosition="Top">
                            <dxe:ComboBoxEdit x:Name="F008ComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Patient.InsuranceDocType, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" NullText="Отсутствует"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutGroup>
                            <dxlc:LayoutItem Label="Номер документа ОМС" LabelPosition="Top" >
                                <dxe:ButtonEdit EditValue="{Binding Patient.InsuranceDocNumber, UpdateSourceTrigger=PropertyChanged}" AllowDefaultButton="False">
                                    <dxe:ButtonInfo GlyphKind="Regular" Command="{Binding SearchPolicyCommand}"/>
                                </dxe:ButtonEdit>
                            </dxlc:LayoutItem>
                            <dxlc:LayoutItem Label="Серия документа ОМС" LabelPosition="Top">
                                <dxe:TextEdit EditValue="{Binding Patient.InsuranceDocSeries, UpdateSourceTrigger=PropertyChanged}"/>
                            </dxlc:LayoutItem>
                        </dxlc:LayoutGroup>
                        <dxlc:LayoutItem Label="ЕНП" LabelPosition="Top">
                            <dxe:ButtonEdit EditValue="{Binding Patient.INP, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" AllowDefaultButton="False">
                                <dxe:ButtonInfo GlyphKind="Regular" Command="{Binding SearchPolicyCommand}"/>
                            </dxe:ButtonEdit>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutGroup>
                            <dxlc:LayoutItem Label="Признак новорожденного" LabelPosition="Top">
                                <dxe:TextEdit EditValue="{Binding Patient.Newborn, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"/>
                            </dxlc:LayoutItem>
                            <dxlc:LayoutItem Label="Вес при рождении" LabelPosition="Top">
                                <dxe:TextEdit EditValue="{Binding Patient.NewbornWeight, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" DisplayFormatString="f2" MaskType="Numeric" ToolTip="Указывается при оказании медицинской помощи недоношенным и маловесным детям. Поле заполняется, если в качестве пациента указан ребёнок."/>
                            </dxlc:LayoutItem>
                        </dxlc:LayoutGroup>
                        <dxlc:LayoutItem Label="Тип УДЛ" LabelPosition="Top">
                            <dxe:ComboBoxEdit x:Name="F011ComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Document.DocType, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" NullText="Отсутствует" AllowNullInput="True"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutGroup>
                            <dxlc:LayoutItem Label="Серия" LabelPosition="Top">
                                <dxe:TextEdit EditValue="{Binding Document.DocSeries, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"/>
                            </dxlc:LayoutItem>
                            <dxlc:LayoutItem Label="Номер" LabelPosition="Top">
                                <dxe:TextEdit EditValue="{Binding Document.DocNum, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"/>
                            </dxlc:LayoutItem>
                        </dxlc:LayoutGroup>

                        <dxlc:LayoutItem Label="Комментарий" LabelPosition="Top">
                            <dxe:MemoEdit EditValue="{Binding Patient.Comments, UpdateSourceTrigger=PropertyChanged}" ShowIcon="False"/>
                        </dxlc:LayoutItem>

                    </dxlc:LayoutGroup>
                    <dxlc:LayoutGroup Header="Условные данные" Orientation="Vertical">
                        <dxlc:LayoutItem Label="Реестровый номер СМО" LabelPosition="Top">
                            <dxe:ButtonEdit EditValue="{Binding Patient.InsuranceId, Converter={StaticResource InsuranceConverter}, UpdateSourceTrigger=PropertyChanged}" NullText="Отсутствует" AllowDefaultButton="False">
                                <dxe:ButtonInfo GlyphKind="Regular" Command="{Binding SearchInsuranceCommand}"/>
                            </dxe:ButtonEdit>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="ОГРН СМО" LabelPosition="Top">
                            <dxe:TextEdit EditValue="{Binding Patient.InsuranceOgrn, UpdateSourceTrigger=PropertyChanged}"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="ОКАТО тер. страхования" LabelPosition="Top">
                            <dxe:ComboBoxEdit x:Name="F010ComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Patient.TerritoryOkato, UpdateSourceTrigger=PropertyChanged}" NullText="Отсутствует"  AutoComplete="True"/>
                            <!--  AutoComplete="True" - By Ira-->
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Наименование СМО" LabelPosition="Top">
                            <dxe:TextEdit EditValue="{Binding Patient.InsuranceName, UpdateSourceTrigger=PropertyChanged}"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Место рождения пациента или представителя" LabelPosition="Top">
                            <dxe:MemoEdit EditValue="{Binding Person.BirthPlace, UpdateSourceTrigger=PropertyChanged}" ShowIcon="False"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="СНИЛС" LabelPosition="Top">
                            <dxe:TextEdit EditValue="{Binding Person.SNILS, UpdateSourceTrigger=PropertyChanged}"/>
                        </dxlc:LayoutItem>
                        <!--<dxlc:LayoutGroup>
                            <dxlc:LayoutItem Label="Код места жительства" LabelPosition="Top">
                                <dxe:ButtonEdit EditValue="{Binding Person.AddressLive, UpdateSourceTrigger=PropertyChanged}" AllowDefaultButton="False">
                                    <dxe:ButtonInfo GlyphKind="Regular" Command="{Binding SearchAddressLiveCommand}"/>
                                </dxe:ButtonEdit>
                            </dxlc:LayoutItem>
                            <dxlc:LayoutItem Label="Код места пребывания" LabelPosition="Top">
                                <dxe:ButtonEdit EditValue="{Binding Person.AddressReg, UpdateSourceTrigger=PropertyChanged}" AllowDefaultButton="False">
                                    <dxe:ButtonInfo GlyphKind="Regular" Command="{Binding SearchAddressRegCommand}"/>
                                </dxe:ButtonEdit>
                            </dxlc:LayoutItem>
                        </dxlc:LayoutGroup>-->
                        <dxlc:LayoutItem Label="Фамилия представителя" LabelPosition="Top">
                            <dxe:TextEdit  EditValue="{Binding Person.RepresentativeSurname, UpdateSourceTrigger=PropertyChanged}"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Имя  представителя" LabelPosition="Top">
                            <dxe:TextEdit  EditValue="{Binding Person.RepresentativeName, UpdateSourceTrigger=PropertyChanged}"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Отчество  представителя" LabelPosition="Top">
                            <dxe:TextEdit  EditValue="{Binding Person.RepresentativePatronymic, UpdateSourceTrigger=PropertyChanged}"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutGroup>
                            <dxlc:LayoutItem Label="Дата рождения  представителя" LabelPosition="Top">
                                <dxe:DateEdit  EditValue="{Binding Person.RepresentativeBirthday, UpdateSourceTrigger=PropertyChanged}" NullText="Отсутствует"/>
                            </dxlc:LayoutItem>
                            <dxlc:LayoutItem Label="Пол  представителя" LabelPosition="Top">
                                <dxe:ComboBoxEdit x:Name="V005ReprComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Person.RepresentativeSex, UpdateSourceTrigger=PropertyChanged}" ShowCustomItems="True" AllowNullInput="True" NullText="Отсутствует" />
                            </dxlc:LayoutItem>
                        </dxlc:LayoutGroup>
                        <dxlc:LayoutItem Label="Регион страхования" LabelPosition="Top"  Visibility="{Binding IsInterMode, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <dxe:ComboBoxEdit x:Name="F010RegionComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Patient.InsuranceRegion, UpdateSourceTrigger=PropertyChanged}" ToolTip="Указывается ОКАТО территории выдачи ДПФС для полисов старого образца при наличии данных" NullText="Отсутствует" ShowCustomItems="True" AllowNullInput="True"/>
                        </dxlc:LayoutItem>
                    </dxlc:LayoutGroup>
                </dxlc:LayoutGroup>
            </dxlc:LayoutGroup>
            <!--Данные случая МП-->
            <dxlc:LayoutGroup Orientation="Vertical">
                <dxlc:LayoutGroup Orientation="Horizontal">
                    <dxlc:LayoutItem Width="150">
                        <dxe:ButtonEdit EditValue="{Binding Mevent.CurrentMedicalEventPositionText, Mode=OneWay}" Height="22" AllowDefaultButton="False" IsReadOnly="True" Width="140">
                            <dxe:ButtonInfo GlyphKind="Right" Command="{Binding Mevent.NextMedicalEventCommand}"/>
                            <dxe:ButtonInfo GlyphKind="Last" Command="{Binding Mevent.LastMedicalEventCommand}"/>
                            <dxe:ButtonInfo GlyphKind="First" IsLeft="True" Command="{Binding Mevent.FirstMedicalEventCommand}"/>
                            <dxe:ButtonInfo GlyphKind="Left" IsLeft="True" Command="{Binding Mevent.PrevMedicalEventCommand}"/>
                        </dxe:ButtonEdit>

                    </dxlc:LayoutItem>
                    <dxlc:LayoutItem Width="50">
                        <dxe:ButtonEdit EditValue="{Binding Mevent.GoToMedicalEventPosition, UpdateSourceTrigger=PropertyChanged}" Height="22" AllowDefaultButton="False"  AcceptsReturn="False">
                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="KeyDown">
                                    <cmd:EventToCommand Command="{Binding Mevent.GoToMedicalEventPositionKeyCommand}" PassEventArgsToCommand="True" />
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                            <dxe:ButtonInfo GlyphKind="Custom" Command="{Binding Mevent.GoToMedicalEventPositionCommand}">
                                <Image Source="../../Resources/Icons/go-next16.png" />
                            </dxe:ButtonInfo>
                        </dxe:ButtonEdit>
                    </dxlc:LayoutItem>
                </dxlc:LayoutGroup>
                <dxlc:LayoutGroup Header="LayoutGroup" View="Tabs" VerticalAlignment="Stretch" >
                    <dxlc:LayoutGroup Header="Случаи МП" View="Group" Orientation="Vertical">

                        <dxlc:LayoutGroup Orientation="Horizontal">
                            <dxlc:LayoutItem Label="ID случая" LabelPosition="Top">
                                <dxe:TextEdit EditValue="{Binding Mevent.MedicalEvent.MedicalEventId, UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True"/>
                            </dxlc:LayoutItem>
                            <dxlc:LayoutItem Label="№ случая" LabelPosition="Top" Visibility="{Binding IsInterMode, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <dxe:TextEdit EditValue="{Binding Mevent.MedicalEvent.ExternalId, UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True"/>
                            </dxlc:LayoutItem>
                            <dxlc:LayoutItem Label="№ случая" LabelPosition="Top" Visibility="{Binding IsLocalMode, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <dxe:TextEdit EditValue="{Binding Mevent.MedicalEvent.MedicalExternalId, UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True"/>
                            </dxlc:LayoutItem>

                        </dxlc:LayoutGroup>
                        <dxlc:LayoutGroup>
                            <dxlc:LayoutItem Label="Вид помощи" LabelPosition="Top">
                                <dxe:ComboBoxEdit x:Name="V008ComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Mevent.MedicalEvent.AssistanceType, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"/>
                            </dxlc:LayoutItem>
                            <dxlc:LayoutItem Label="Код типа посещения" LabelPosition="Top" Visibility="{Binding IsLocalMode, Converter={StaticResource BooleanToVisibilityConverter}}">
                                <dxe:ComboBoxEdit x:Name="EventTypeComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Mevent.MedicalEvent.EventType, UpdateSourceTrigger=PropertyChanged}" NullText="Отсутствует"/>
                            </dxlc:LayoutItem>
                        </dxlc:LayoutGroup>
                        <dxlc:LayoutGroup>
                            <dxlc:LayoutItem Label="Условия оказания помощи" LabelPosition="Top">
                                <dxe:ComboBoxEdit x:Name="V006ComboBoxEdit" DisplayMember="DisplayField" ValueMember="ValueField" EditValue="{Binding Mevent.MedicalEvent.AssistanceConditions, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" NullText="Отсутствует" AllowNullInput="True"/>
                            </dxlc:LayoutItem>
                            <dxlc:LayoutItem Label="Форма оказания МП" LabelPosition="Top">
                                <dxe:ComboBoxEdit x:Name="V014ComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Mevent.MedicalEvent.AssistanceForm, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" NullText="Отсутствует"/>
                            </dxlc:LayoutItem>

                        </dxlc:LayoutGroup>
                        <dxlc:LayoutGroup>
                            <dxlc:LayoutItem Label="Код МО" LabelPosition="Top">
                                <dxe:ButtonEdit EditValue="{Binding Mevent.MedicalEvent.MedicalOrganizationCode, Converter={StaticResource MedicalOrganizationConverter}, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" AllowDefaultButton="False">
                                    <dxe:ButtonInfo GlyphKind="Regular" Command="{Binding SelectMeventMedicalOrganizationCodeCommand}"/>
                                </dxe:ButtonEdit>
                            </dxlc:LayoutItem>
                            <dxlc:LayoutItem Label="Код врача" LabelPosition="Top">
                                <dxe:ButtonEdit EditValue="{Binding Mevent.MedicalEvent.DoctorId, UpdateSourceTrigger=PropertyChanged}" AllowDefaultButton="False">
                                    <dxe:ButtonInfo GlyphKind="Regular" Command="{Binding SelectMeventDoctorCommand}"/>
                                </dxe:ButtonEdit>
                            </dxlc:LayoutItem>
                        </dxlc:LayoutGroup>
                        <dxlc:LayoutGroup>
                            <dxlc:LayoutItem Label="№ истории болезни/талона" LabelPosition="Top">
                                <dxe:TextEdit EditValue="{Binding Mevent.MedicalEvent.History, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"/>
                            </dxlc:LayoutItem>
                            <dxlc:LayoutItem Label="детский профиль" LabelPosition="Top" Width="120" HorizontalAlignment="Right">
                                <CheckBox HorizontalAlignment="Left" Height="18" VerticalAlignment="Top" IsChecked="{Binding Mevent.MedicalEvent.IsChildren, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"/>
                            </dxlc:LayoutItem>
                        </dxlc:LayoutGroup>
                        <dxlc:LayoutGroup>
                            <dxlc:LayoutItem Label="Начало лечения" LabelPosition="Top">
                                <dxe:DateEdit EditValue="{Binding Mevent.MedicalEvent.EventBegin, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" NullText="Отсутствует"/>
                            </dxlc:LayoutItem>
                            <dxlc:LayoutItem Label="Окончание" LabelPosition="Top">
                                <dxe:DateEdit EditValue="{Binding Mevent.MedicalEvent.EventEnd, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" NullText="Отсутствует"/>
                            </dxlc:LayoutItem>
                        </dxlc:LayoutGroup>
                        <dxlc:LayoutItem Label="Основной диагноз" LabelPosition="Top">
                            <dxe:ButtonEdit EditValue="{Binding Mevent.MedicalEvent.DiagnosisGeneral, Converter={StaticResource DiagnosisConverter}, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" AllowDefaultButton="False">
                                <dxe:ButtonInfo GlyphKind="Regular" Command="{Binding SelectDiagnosisGeneralCommand}"/>
                            </dxe:ButtonEdit>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutGroup>
                            <dxlc:LayoutItem Label="Результат" LabelPosition="Top">
                                <dxe:ComboBoxEdit x:Name="V009ComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" ItemsSource="{Binding SelectedItem.DataField.Item2, ElementName=V006ComboBoxEdit}" EditValue="{Binding Mevent.MedicalEvent.Result, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" NullText="Отсутствует" AllowUpdateTwoWayBoundPropertiesOnSynchronization="False"/>
                            </dxlc:LayoutItem>
                            <dxlc:LayoutItem Label="Исход" LabelPosition="Top">
                                <dxe:ComboBoxEdit x:Name="V012ComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" ItemsSource="{Binding SelectedItem.DataField.Item1, ElementName=V006ComboBoxEdit}" EditValue="{Binding Mevent.MedicalEvent.Outcome, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" NullText="Отсутствует" AllowUpdateTwoWayBoundPropertiesOnSynchronization="False"/>
                            </dxlc:LayoutItem>
                        </dxlc:LayoutGroup>
                        <dxlc:LayoutItem Label="Профиль мед. помощи" LabelPosition="Top">
                            <dxe:ComboBoxEdit x:Name="V002MeventComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Mevent.MedicalEvent.ProfileCodeId, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" NullText="Отсутствует" AutoComplete="True" ImmediatePopup="True" IncrementalFiltering="True"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Код специальности" LabelPosition="Top">
                            <dxe:ComboBoxEdit x:Name="V004MeventComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Mevent.MedicalEvent.SpecialityCode, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" NullText="Отсутствует" AutoComplete="True" ImmediatePopup="True" IncrementalFiltering="True"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Код спец. (V015)" LabelPosition="Top">
                            <dxe:ComboBoxEdit x:Name="V015MeventComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Mevent.MedicalEvent.SpecialityCodeV015, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" NullText="Отсутствует" AutoComplete="True" ImmediatePopup="True" IncrementalFiltering="True"/>
                        </dxlc:LayoutItem>

                        <dxlc:LayoutItem Label="Комментарий" LabelPosition="Top">
                            <dxe:MemoEdit EditValue="{Binding Mevent.MedicalEvent.Comments, UpdateSourceTrigger=PropertyChanged}" ShowIcon="False"/>
                        </dxlc:LayoutItem>

                    </dxlc:LayoutGroup>
                    <dxlc:LayoutGroup Header="Условные данные" Orientation="Vertical">
                        <dxlc:LayoutItem Label="Код МО, направившего пациента" LabelPosition="Top" ToolTip="Код МО, направившего на лечение (диагностику, консультацию)">
                            <dxe:ButtonEdit EditValue="{Binding Mevent.MedicalEvent.ReferralOrganization, Converter={StaticResource MedicalOrganizationIdConverter}, UpdateSourceTrigger=PropertyChanged}" AllowDefaultButton="False">
                                <dxe:ButtonInfo GlyphKind="Regular" Command="{Binding SelectMeventReferralOrganizationCommand}"/>
                            </dxe:ButtonEdit>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Направление госпитализации" LabelPosition="Top">
                            <dxe:ComboBoxEdit x:Name="HospitalizationComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Mevent.MedicalEvent.Hospitalization, UpdateSourceTrigger=PropertyChanged}" AllowNullInput="True" ShowCustomItems="True" NullText="Отсутствует"/>
                        </dxlc:LayoutItem>

                        <dxlc:LayoutItem Label="Код отделения" LabelPosition="Top">
                            <dxe:ButtonEdit EditValue="{Binding Mevent.MedicalEvent.Department, UpdateSourceTrigger=PropertyChanged}" AllowDefaultButton="False">
                                <dxe:ButtonInfo GlyphKind="Regular" Command="{Binding SelectMeventDepartmentCommand}"/>
                            </dxe:ButtonEdit>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Подразделение МО" LabelPosition="Top">
                            <dxe:ComboBoxEdit EditValue="{Binding Mevent.MedicalEvent.Subdivision, UpdateSourceTrigger=PropertyChanged}"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Первичный диагноз" LabelPosition="Top">
                            <dxe:ButtonEdit EditValue="{Binding Mevent.MedicalEvent.DiagnosisPrimary, Converter={StaticResource DiagnosisConverter}, UpdateSourceTrigger=PropertyChanged}" AllowDefaultButton="False">
                                <dxe:ButtonInfo GlyphKind="Regular" Command="{Binding SelectMeventDiagnosisPrimaryCommand}"/>
                            </dxe:ButtonEdit>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Диагноз сопутствующего заболевания" LabelPosition="Top">
                            <dxe:ButtonEdit EditValue="{Binding Mevent.MedicalEvent.DiagnosisSecondary, Converter={StaticResource DiagnosisConverter}, UpdateSourceTrigger=PropertyChanged}" AllowDefaultButton="False">
                                <dxe:ButtonInfo GlyphKind="Regular" Command="{Binding SelectMeventDiagnosisSecondaryCommand}"/>
                            </dxe:ButtonEdit>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Код МЭС" LabelPosition="Top">
                            <dxe:TextEdit EditValue="{Binding Mevent.MedicalEvent.MES, UpdateSourceTrigger=PropertyChanged}"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Код МЭС сопутствующий" LabelPosition="Top">
                            <dxe:TextEdit EditValue="{Binding Mevent.MedicalEvent.SecondaryMES, UpdateSourceTrigger=PropertyChanged}"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Особый случай" LabelPosition="Top">
                            <dxe:ComboBoxEdit EditValue="{Binding Mevent.MedicalEvent.ParticularCase, UpdateSourceTrigger=PropertyChanged}"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Вес при рождении" LabelPosition="Top">
                            <dxe:TextEdit EditValue="{Binding Mevent.MedicalEvent.NewbornsWeightAggregate, UpdateSourceTrigger=PropertyChanged}"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Региональный признак" LabelPosition="Top" Visibility="{Binding IsLocalMode, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <dxe:ComboBoxEdit x:Name="RegionalAttributeComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Mevent.MedicalEvent.RegionalAttribute, UpdateSourceTrigger=PropertyChanged}" AllowNullInput="True" ShowCustomItems="True" NullText="Отсутствует"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Группа здоровья" LabelPosition="Top" Visibility="{Binding IsLocalMode, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <dxe:ComboBoxEdit x:Name="HealthGroupComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Mevent.MedicalEvent.HealthGroup, UpdateSourceTrigger=PropertyChanged}" AllowNullInput="True" ShowCustomItems="True" NullText="Отсутствует"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Статус занятости" LabelPosition="Top" Visibility="{Binding IsLocalMode, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <dxe:ComboBoxEdit x:Name="JobStatusComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Mevent.MedicalEvent.JobStatus_Id, UpdateSourceTrigger=PropertyChanged}" AllowNullInput="True" ShowCustomItems="True" NullText="Отсутствует"/>
                        </dxlc:LayoutItem>
                    </dxlc:LayoutGroup>
                </dxlc:LayoutGroup>

            </dxlc:LayoutGroup>

            <!--Данные услуги-->

            <dxlc:LayoutGroup x:Name="ServiceGroup" Orientation="Vertical">
                <dxlc:LayoutGroup IsEnabled="{Binding Services, Converter={StaticResource BooleanToVisibilityConverter}}" Orientation="Horizontal">
                    <dxlc:LayoutItem Width="150">
                        <dxe:ButtonEdit EditValue="{Binding Mservice.CurrentMedicalServicePositionText, Mode=OneWay}" Height="22" AllowDefaultButton="False" IsReadOnly="True" Width="140">
                            <dxe:ButtonInfo GlyphKind="Right" Command="{Binding Mservice.NextMedicalServiceCommand}"/>
                            <dxe:ButtonInfo GlyphKind="Last" Command="{Binding Mservice.LastMedicalServiceCommand}"/>
                            <dxe:ButtonInfo GlyphKind="First" IsLeft="True" Command="{Binding Mservice.FirstMedicalServiceCommand}"/>
                            <dxe:ButtonInfo GlyphKind="Left" IsLeft="True" Command="{Binding Mservice.PrevMedicalServiceCommand}"/>
                        </dxe:ButtonEdit>

                    </dxlc:LayoutItem>
                    <dxlc:LayoutItem Width="50">
                        <dxe:ButtonEdit EditValue="{Binding Mservice.GoToMedicalServicePosition, UpdateSourceTrigger=PropertyChanged}" Height="22" AllowDefaultButton="False" AcceptsReturn="False">
                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="KeyDown">
                                    <cmd:EventToCommand Command="{Binding Mservice.GoToMedicalServicePositionKeyCommand}" PassEventArgsToCommand="True" />
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                            <dxe:ButtonInfo GlyphKind="Custom" Command="{Binding Mservice.GoToMedicalServicePositionCommand}">
                                <Image Source="../../Resources/Icons/go-next16.png" />
                            </dxe:ButtonInfo>
                        </dxe:ButtonEdit>
                    </dxlc:LayoutItem>
                </dxlc:LayoutGroup>
                <dxlc:LayoutGroup Header="ServiceLayoutGroup" View="Tabs" Visibility="{Binding Services, Converter={StaticResource BooleanToVisibilityConverter}}" VerticalAlignment="Stretch">
                    <dxlc:LayoutGroup Header="Услуги" View="Group" Orientation="Vertical">
                        <dxlc:LayoutGroup Orientation="Horizontal">
                            <dxlc:LayoutItem Label="ID услуги" LabelPosition="Top">
                                <dxe:TextEdit EditValue="{Binding Mservice.MedicalService.MedicalServicesId, UpdateSourceTrigger=PropertyChanged}" IsReadOnly="True"/>
                            </dxlc:LayoutItem>

                            <dxlc:LayoutItem Label="№ услуги" LabelPosition="Top">
                                <dxe:TextEdit EditValue="{Binding Mservice.MedicalService.ExternalGUID, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"/>
                            </dxlc:LayoutItem>

                        </dxlc:LayoutGroup>
                        <dxlc:LayoutGroup>
                            <dxlc:LayoutItem Label="Код МО" LabelPosition="Top">
                                <dxe:ButtonEdit EditValue="{Binding Mservice.MedicalService.MedicalOrganizationCode, Converter={StaticResource MedicalOrganizationConverter}, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" AllowDefaultButton="False">
                                    <dxe:ButtonInfo GlyphKind="Regular" Command="{Binding SelectMserviceMedicalOrganizationCommand}"/>
                                </dxe:ButtonEdit>
                            </dxlc:LayoutItem>
                            <dxlc:LayoutItem Label="Код мед. работника" LabelPosition="Top">
                                <dxe:ButtonEdit EditValue="{Binding Mservice.MedicalService.DoctorId, UpdateSourceTrigger=PropertyChanged}" AllowDefaultButton="False">
                                    <dxe:ButtonInfo GlyphKind="Regular" Command="{Binding SelectMserviceDoctorCommand}"/>
                                </dxe:ButtonEdit>
                            </dxlc:LayoutItem>
                        </dxlc:LayoutGroup>


                        <dxlc:LayoutItem Label="Профиль мед. помощи" LabelPosition="Top">
                            <dxe:ComboBoxEdit x:Name="V002ServiceComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Mservice.MedicalService.Profile, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" NullText="Отсутствует"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutGroup>
                            <dxlc:LayoutItem Label="Начало оказания услуги" LabelPosition="Top">
                                <dxe:DateEdit EditValue="{Binding Mservice.MedicalService.ServiceBegin, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" NullText="Отсутствует"/>
                            </dxlc:LayoutItem>
                            <dxlc:LayoutItem Label="Окончание" LabelPosition="Top">
                                <dxe:DateEdit EditValue="{Binding Mservice.MedicalService.ServiceEnd, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" NullText="Отсутствует"/>
                            </dxlc:LayoutItem>
                        </dxlc:LayoutGroup>
                        <dxlc:LayoutGroup dx:ScrollViewerTouchBehavior.IsEnabled="True" Serialization:SerializableItem.TypeName="LayoutGroup">
                            <dxlc:LayoutItem Label="Диагноз" LabelPosition="Top">
                                <dxe:ButtonEdit EditValue="{Binding Mservice.MedicalService.Diagnosis, Converter={StaticResource DiagnosisConverter}, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" AllowDefaultButton="False">
                                    <dxe:ButtonInfo GlyphKind="Regular" Command="{Binding SelectMserviceDiagnosisCommand}"/>
                                </dxe:ButtonEdit>
                            </dxlc:LayoutItem>
                            <dxlc:LayoutItem Label="детский профиль" LabelPosition="Top">
                                <CheckBox HorizontalAlignment="Left" Height="18" VerticalAlignment="Top" IsChecked="{Binding Mservice.MedicalService.IsChildren, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"/>
                            </dxlc:LayoutItem>
                        </dxlc:LayoutGroup>
                        <dxlc:LayoutItem Label="Код услуги" LabelPosition="Top" Visibility="{Binding IsLocalMode, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <dxe:TextEdit EditValue="{Binding Mservice.MedicalService.ServiceCode, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" />
                        </dxlc:LayoutItem>

                        <dxlc:LayoutItem Label="Наименование услуги" LabelPosition="Top"><!--By Ira-->
                            <!--Visibility="{Binding IsInterMode, Converter={StaticResource BooleanToVisibilityConverter}}"-->
                            <dxe:TextEdit EditValue="{Binding Mservice.MedicalService.ServiceName, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" ToolTip="{Binding Mservice.MedicalService.ServiceName, Mode=OneWay}"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutGroup>
                            <dxlc:LayoutItem Label="Количество услуг" ToolTip="Кратность" LabelPosition="Top">
                                <dxe:TextEdit EditValue="{Binding Mservice.MedicalService.Quantity, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" MaskType="Numeric" DisplayFormatString="f2"/>
                            </dxlc:LayoutItem>
                            <dxlc:LayoutItem Label="Тариф" LabelPosition="Top">
                                <dxe:TextEdit EditValue="{Binding Mservice.MedicalService.Rate, UpdateSourceTrigger=PropertyChanged}" DisplayFormatString="c" MaskType="Numeric"/>
                            </dxlc:LayoutItem>
                        </dxlc:LayoutGroup>
                        <dxlc:LayoutItem Label="Стоимость медицинской услуги" LabelPosition="Top">
                            <dxe:TextEdit EditValue="{Binding Mservice.MedicalService.Price, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" DisplayFormatString="c" MaskType="Numeric"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Специальность мед. работника" LabelPosition="Top">
                            <dxe:ComboBoxEdit x:Name="V004ServiceComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Mservice.MedicalService.SpecialityCode, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" NullText="Отсутствует"/>
                        </dxlc:LayoutItem>

                        <dxlc:LayoutItem Label="Специальность мед. работника (V015)" LabelPosition="Top">
                            <dxe:ComboBoxEdit x:Name="V015ServiceComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Mservice.MedicalService.SpecialityCodeV015, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" NullText="Отсутствует"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Вид медицинского вмешательства" LabelPosition="Top">
                            <dxe:ComboBoxEdit EditValue="{Binding Mservice.MedicalService.SurgeryType, UpdateSourceTrigger=PropertyChanged}" NullText="Отсутствует"/>
                        </dxlc:LayoutItem>
                    </dxlc:LayoutGroup>
                    <dxlc:LayoutGroup Header="Флаги" View="Group" Orientation="Vertical">
                        <dxlc:LayoutItem Label="Признак проведения услуги" LabelPosition="Left">
                            <CheckBox HorizontalAlignment="Left" Height="18" VerticalAlignment="Top" IsChecked="{Binding Mservice.MedicalService.IsServiceBeforeEvent, UpdateSourceTrigger=PropertyChanged}"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Отказ от услуги" LabelPosition="Left">
                            <CheckBox HorizontalAlignment="Left" Height="18" VerticalAlignment="Top" IsChecked="{Binding Mservice.MedicalService.IsServiceRefuse, UpdateSourceTrigger=PropertyChanged}"/>
                        </dxlc:LayoutItem>
                    </dxlc:LayoutGroup>
                </dxlc:LayoutGroup>
                <dxlc:LayoutItem Visibility="{Binding NoServices, Converter={StaticResource BooleanToVisibilityConverter}}" VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
                    <Label FontSize="16" FontWeight="Bold" VerticalAlignment="Center" HorizontalAlignment="Center" Content="Услуги отсутствуют"/>
                </dxlc:LayoutItem>
            </dxlc:LayoutGroup>

            <dxlc:LayoutGroup Header="LayoutGroup" View="Tabs" VerticalAlignment="Stretch">
                <dxlc:LayoutGroup Header="Оплата" Orientation="Vertical">
                    <dxlc:LayoutItem Label="Код способа оплаты" LabelPosition="Top">
                        <dxe:ComboBoxEdit x:Name="V010ComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Mevent.MedicalEvent.PaymentMethod, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" NullText="Отсутствует"/>
                    </dxlc:LayoutItem>
                    <dxlc:LayoutGroup>
                        <dxlc:LayoutItem Label="Количество ед. оплаты" LabelPosition="Top">
                            <dxe:TextEdit EditValue="{Binding Mevent.MedicalEvent.Quantity, UpdateSourceTrigger=PropertyChanged}" MaskType="Numeric" DisplayFormatString="f2"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Тариф" LabelPosition="Top">
                            <dxe:TextEdit EditValue="{Binding Mevent.MedicalEvent.Rate, UpdateSourceTrigger=PropertyChanged}" DisplayFormatString="c" MaskType="Numeric"/>
                        </dxlc:LayoutItem>
                    </dxlc:LayoutGroup>
                    <dxlc:LayoutGroup>
                        <dxlc:LayoutItem Label="Сумма выставленная" LabelPosition="Top" Visibility="{Binding IsInterMode, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <dxe:TextEdit EditValue="{Binding Mevent.MedicalEvent.Price, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" DisplayFormatString="c" MaskType="Numeric"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Сумма выставленная" LabelPosition="Top" Visibility="{Binding IsLocalMode, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <dxe:TextEdit EditValue="{Binding Mevent.MedicalEvent.MoPrice, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" DisplayFormatString="c" MaskType="Numeric"/>
                        </dxlc:LayoutItem>
                        <dxlc:LayoutItem Label="Сумма принятая" LabelPosition="Top">
                            <dxe:TextEdit EditValue="{Binding Mevent.MedicalEvent.AcceptPrice, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" DisplayFormatString="c" MaskType="Numeric"/>
                        </dxlc:LayoutItem>
                    </dxlc:LayoutGroup>
                    <dxlc:LayoutItem Label="Статус оплаты" LabelPosition="Top" Visibility="{Binding IsInterMode, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <dxe:ComboBoxEdit x:Name="F005ComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Mevent.MedicalEvent.PaymentStatus, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" NullText="Отсутствует"/>
                    </dxlc:LayoutItem>
                    <dxlc:LayoutItem Label="Статус оплаты" LabelPosition="Top" Visibility="{Binding IsLocalMode, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <dxe:ComboBoxEdit x:Name="F005ComboBoxEdit2" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Mevent.MedicalEvent.MoPaymentStatus, NotifyOnValidationError=True, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}" NullText="Отсутствует"/>
                    </dxlc:LayoutItem>
                    <dxlc:LayoutItem Label="Сумма санкций по случаю" LabelPosition="Top">
                        <dxe:TextEdit EditValue="{Binding Refusal.RefusalPrice, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" DisplayFormatString="c" MaskType="Numeric" IsReadOnly="True"/>
                    </dxlc:LayoutItem>
                    <dxlc:LayoutItem Label="Штрафные санкции">
                        <Separator/>
                    </dxlc:LayoutItem>
                    <dxlc:LayoutItem>
                        <dxe:ButtonEdit AllowDefaultButton="False" HorizontalAlignment="Left" ShowText="False" Height="36">
                            <dxe:ButtonInfo GlyphKind="Custom" ToolTip="Удалить отказ" Command="{Binding DeleteRefusalCommand}">
                                <Image Source="../../Resources/Icons/dialog-cancel.png" />
                            </dxe:ButtonInfo>
                            <dxe:ButtonInfo GlyphKind="Custom" ToolTip="Добавить МЭК" Command="{Binding AddMecCommand}">
                                <Image Source="../../Resources/Icons/mec.png" />
                            </dxe:ButtonInfo>
                            <dxe:ButtonInfo GlyphKind="Custom" ToolTip="Добавить МЭЭ" Command="{Binding AddMeeCommand}">
                                <Image Source="../../Resources/Icons/mee.png" />
                            </dxe:ButtonInfo>
                            <dxe:ButtonInfo GlyphKind="Custom" ToolTip="Добавить ЭКМП" Command="{Binding AddEqmaCommand}">
                                <Image Source="../../Resources/Icons/eqma.png" />
                            </dxe:ButtonInfo>
                            <dxe:ButtonInfo GlyphKind="Custom" ToolTip="Заблокировать отказ" Command="{Binding BlockRefuseCommand}">
                                <Image Source="../../Resources/Icons/lock.png" />
                            </dxe:ButtonInfo>
                            <dxe:ButtonInfo GlyphKind="Custom" ToolTip="Согласиться с отказом" Command="{Binding AgreeRefuseCommand}" CommandParameter="1">
                                <Image Source="../../Resources/Icons/dialog-apply.png" />
                            </dxe:ButtonInfo>
                            <dxe:ButtonInfo GlyphKind="Custom" ToolTip="Не согласиться с отказом" Command="{Binding AgreeRefuseCommand}" CommandParameter="0">
                                <Image Source="../../Resources/Icons/edit-delete.png" />
                            </dxe:ButtonInfo>
                            <dxe:ButtonInfo GlyphKind="Custom" ToolTip="Редактировать отказ" Command="{Binding EditRefuseCommand}">
                                <Image Source="../../Resources/Icons/edit.png" />
                            </dxe:ButtonInfo>
                        </dxe:ButtonEdit>
                    </dxlc:LayoutItem>
                    <dxg:GridControl 
                        ItemsSource="{Binding Refusal.MedicalRefusals}"
                        Height="120" 
                        ShowBorder="False">
                        <dxg:GridControl.Resources>
                            <Style x:Key="optimizedRowStyle" TargetType="{x:Type dxg:RowControl}">
                                <Style.Triggers>
                                    <Trigger Property="dxg:DataViewBase.IsFocusedRow" Value="True">
                                        <Setter Property="Background" Value="{Binding Row.RefusalType, Converter={StaticResource RefusalTypeToColorConverter}, FallbackValue={x:Null}}"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                    </Trigger>
                                    <Trigger Property="dxg:DataViewBase.IsFocusedRow" Value="False">
                                        <Setter Property="Background" Value="{Binding Row.RefusalType, Converter={StaticResource RefusalTypeToColorConverter}, FallbackValue={x:Null}}"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </dxg:GridControl.Resources>

                        <dxg:GridControl.View>
                            <dxg:TableView 
                                AllowPerPixelScrolling="True" 
                                AllowGrouping="False" 
                                ShowGroupPanel="False"
                                AllowEditing="False" 
                                ShowIndicator="True"
                                AllowCascadeUpdate="True"        
                                NavigationStyle="Row"
                                WaitIndicatorType="Panel"
                                RowAnimationKind="None"
                                HeaderPanelMinHeight="35"
                                FocusedRow="{Binding Refusal.SelectedRefusal, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                RowStyle="{StaticResource optimizedRowStyle}"/>
                        </dxg:GridControl.View>
                        <dxg:GridColumn FieldName="Dest" Header=" " Width="22">
                            <dxg:GridColumn.CellTemplate>
                                <DataTemplate>
                                    <Image Height="22" Width="22" HorizontalAlignment="Center" Source="{Binding RowData.Row.Dest, Converter={StaticResource RefusalDestToImageConverter}}">
                                        
                                    </Image>
                                </DataTemplate>
                            </dxg:GridColumn.CellTemplate>
                        </dxg:GridColumn>
                        <dxg:GridColumn FieldName="RefusalType" Header=" " Width="22">
                            <dxg:GridColumn.CellTemplate>
                                <DataTemplate>
                                    <Image Height="22" Width="22" HorizontalAlignment="Center" Source="{Binding RowData.Row.RefusalType, Converter={StaticResource RefusalTypeToImageConverter}}">
                                        
                                    </Image>
                                </DataTemplate>
                            </dxg:GridColumn.CellTemplate>
                        </dxg:GridColumn>
                        <dxg:GridColumn FieldName="Flag" Header=" " Width="22">
                            <dxg:GridColumn.CellTemplate>
                                <DataTemplate>
                                    <Image Height="22" Width="22" HorizontalAlignment="Center" Source="{Binding RowData.Row.Flag, Converter={StaticResource RefusalFlagToImageConverter}}">
                                        
                                    </Image>
                                </DataTemplate>
                            </dxg:GridColumn.CellTemplate>
                        </dxg:GridColumn>
                        <dxg:GridColumn FieldName="ReasonCode" Header="Код отказа" FixedWidth="True" Width="80"/>
                        <dxg:GridColumn FieldName="Amount" Header="Сумма" FixedWidth="True" Width="100">
                            <dxg:GridColumn.EditSettings>
                                <dxe:TextEditSettings DisplayFormat="c2" MaskType="Numeric"  Mask="c2"  TextWrapping="WrapWithOverflow"/>
                            </dxg:GridColumn.EditSettings>
                        </dxg:GridColumn>

                    </dxg:GridControl>
                    <dxlc:LayoutItem Label="Сумма отказа" LabelPosition="Top">
                        <dxe:TextEdit EditValue="{Binding Refusal.SelectedRefusal.Amount}" DisplayFormatString="c" MaskType="Numeric" IsReadOnly="True" Foreground="Gray"/>
                    </dxlc:LayoutItem>
                    <dxlc:LayoutItem Label="Код причины отказа" LabelPosition="Top">
                        <dxe:ComboBoxEdit x:Name="F014ComboBoxEdit" DisplayMember="DisplayName" ValueMember="Value" EditValue="{Binding Refusal.SelectedRefusal.ReasonId, UpdateSourceTrigger=PropertyChanged}" NullText="Отсутствует" IsReadOnly="True" Foreground="Gray"/>
                    </dxlc:LayoutItem>
                    <dxlc:LayoutItem Label="Комментарий" LabelPosition="Top">
                        <dxe:MemoEdit EditValue="{Binding Refusal.SelectedRefusal.Comments, UpdateSourceTrigger=PropertyChanged}" ShowIcon="False" IsReadOnly="True" Foreground="Gray"/>
                    </dxlc:LayoutItem>
                </dxlc:LayoutGroup>
            </dxlc:LayoutGroup>

        </dxlc:LayoutControl>
    </Grid>

</UserControl>
